# 服务链路基础教程

本教程将指导您在服务提供方账号下创建一个服务后端，并在另一个服务使用方账号下创建一个服务端点。在服务后端部署业务完成后，通过服务使用方的客户端访问服务端点来实现访问服务后端业务。

## 业务场景架构

![服务链路架构](../../../../image/Networking/Service-Link/servicelink-arch.png)

## 开始之前

**步骤1**：准备两个京东云账号，一个作为服务提供方账号，本教程称为服务端账号；另一个作为服务使用方账号，本教程称为客户端账号。

**步骤2**：在服务端账号下，创建一台云主机，并在该云主机上部署业务，通过80端口对外提供服务。

**步骤3**：在服务端账号下，创建一个网络负载均衡，该网络负载均衡监听80端口。网络负载均衡挂载步骤1中创建的云主机，并将流量转发至云主机80端口。

**步骤4**：在服务端账号下，通过网络负载均衡公网IP或内网IP地址访问其80端口业务，验证业务部署成功。

**步骤5**：在客户端账号下，创建一个私有网络以及子网，并按照要求设置正确的CIDR、网络ACL以及路由表配置。

**步骤6**：在客户端账号下，在上一步创建的子网中创建一台云主机，并为该云主机关联默认安全组以及关联弹性公网IP。

## 服务后端创建

**步骤1**：登录服务端账号京东云控制台，进入服务后端列表页，点击创建按键进入服务后端创建弹窗。

**步骤2**：在服务后端创建弹窗中，选择负载均衡类型为网络负载均衡，在负载均衡列表中选择之前本教程中创建的网络负载均衡。

**步骤3**：在服务后端创建弹窗中，不启用自动接受连接选项。

**步骤4**：点击确定按键完成服务后端创建，并返回服务后端列表页查看服务后端创建情况。

**步骤5**：在服务后端列表页，定位到刚才创建的服务后端，点击服务后端ID进入服务后端详情页，并切换至白名单管理页。

**步骤6**：在白名单管理页，点击添加按键进入添加白名单用户弹窗。

**步骤7**：在添加白名单用户弹窗，选择自定义名单方式，将准备好的客户端账号PIN添加至输入框中。

**步骤8**：点击确定按键完成白名单用户添加，并返回白名单管理页查看用户添加情况。

## 服务端点创建

**步骤1**：登录客户端账号京东云控制台，进入服务端点列表页，点击创建按键进入服务端点创建页。

**步骤2**：在服务端点创建页中，选择本教程创建的服务后端所在的地域。

**步骤3**：在服务端点创建页中，选择服务后端类型为私有，在检索框中输入本教程创建的服务后端名称，点击检索按键，列表中出现对应的服务后端相关信息。

**步骤4**：选中列表中的服务后端。

**步骤5**：在服务端点创建页中，选择本教程中创建的私有网络以及子网，按照默认配置由系统自动分配IP地址，并为该服务端点关联默认安全组。

**步骤6**：在服务端点创建页中，按照要求填写服务端点名称以及描述信息。

**步骤7**：在服务端点创建页中，正确完成以上步骤后，点击立即购买按键，进入订单确认页。

**步骤8**：在订单确认页，确认服务端点相关信息，点击立即开通，返回服务端点列表页查看服务端点创建情况。

## 服务后端接受连接

**步骤1**：登录客户端账号京东云控制台，进入服务端点列表页，查看本教程中创建的服务端点处于待接受状态。

**步骤2**：登录服务端账号京东云控制台，进入服务后端列表页，定位到本教程中创建的服务后端，点击服务后端ID进入服务后端详情页，并切换至服务端点管理页面。

**步骤3**：在服务端点管理页面，定位到本教程中客户端账号所创建的服务端点，点击操作栏中的接受连接按键进入接受连接弹窗。

**步骤4**：在接受连接弹窗中，确认服务端点信息，点击确定接受该服务端点连接，服务端点进入处理中状态。

**步骤5**：登录客户端账号京东云控制台，进入服务端点列表页，查看本教程中创建的服务端点处于处理中状态，处理完成后，服务端点进入已接收状态。

## 服务端点访问服务后端

**步骤1**：通过SSH远程登录至客户端账号下的云主机。

**步骤2**：登录客户端账号京东云控制台，进入服务端点列表页，定位到本教程中创建的服务端点，查看该服务端点的VIP地址。

**步骤3**：在SSH登录的云主机上执行以下命令，中括号中为服务端点VIP地址，路径中不包含中括号。

	# curl http://[service endpoint vip]:80

**步骤4**：执行以上命令后，获得正确响应，证明服务后端与服务端点均正常工作。
